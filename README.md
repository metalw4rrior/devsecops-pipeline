
# DevSecOps Pipeline

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π CI/CD –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è —Å–±–æ—Ä–∫–∏, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –¥–µ–ø–ª–æ—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ Kubernetes –∫–ª–∞—Å—Ç–µ—Ä–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º GitLab Runner, —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –≤–Ω—É—Ç—Ä–∏ –ø–æ–¥–∞ Kubernetes.

## üõ† –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **GitLab** ‚Äì CI/CD –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞
- **Docker** ‚Äì –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- **SonarQube** ‚Äì –∞–Ω–∞–ª–∏–∑ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞
- **Safety** ‚Äì —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π Python
- **Bandit** ‚Äì —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Python
- **Kubernetes** ‚Äì –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```bash
.
‚îú‚îÄ‚îÄ app/                      # –ü—Ä–∏–º–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ .gitlab-ci.yml             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è CI/CD –ø–∞–π–ø–ª–∞–π–Ω–∞
‚îú‚îÄ‚îÄ sonar-project.properties   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è SonarQube
‚îú‚îÄ‚îÄ kubeconfig.yaml            # –ü—Ä–∏–º–µ—Ä Kubernetes –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ your-app.yaml              # –ü—Ä–∏–º–µ—Ä –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞ –¥–ª—è Kubernetes
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CI/CD

–î–ª—è —Ä–∞–±–æ—Ç—ã –ø–∞–π–ø–ª–∞–π–Ω–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ GitLab.

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è Kubernetes –∏ Docker

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è                | –û–ø–∏—Å–∞–Ω–∏–µ                                                               |
|---------------------------|------------------------------------------------------------------------|
| `KUBERNETES_API_URL`       | –ê–¥—Ä–µ—Å API Kubernetes –∫–ª–∞—Å—Ç–µ—Ä–∞                                          |
| `KUBERNETES_NAMESPACE`     | –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∏–º–µ–Ω, –≥–¥–µ –±—É–¥–µ—Ç —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ                     |
| `KUBERNETES_CA_CERT`       | –ö–æ—Ä–Ω–µ–≤–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç Kubernetes                                         |
| `KUBERNETES_CLIENT_CERT`   | –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∫–ª–∏–µ–Ω—Ç–∞ (—Ä–æ–ª–∏), —Å –∫–æ—Ç–æ—Ä—ã–º —Ä–∞–±–æ—Ç–∞–µ—Ç —Ä–∞–Ω–Ω–µ—Ä                   |
| `KUBERNETES_CLIENT_KEY`    | –ö–ª—é—á –∫–ª–∏–µ–Ω—Ç–∞ (—Ä–æ–ª–∏), —Å –∫–æ—Ç–æ—Ä—ã–º —Ä–∞–±–æ—Ç–∞–µ—Ç —Ä–∞–Ω–Ω–µ—Ä                         |
| `DOCKER_USER`              | –õ–æ–≥–∏–Ω –¥–ª—è Docker registry                                              |
| `DOCKER_PASSWORD`          | –ü–∞—Ä–æ–ª—å –¥–ª—è Docker registry                                             |
| `DOCKER_SOCK`              | `unix:///var/run/docker.sock` ‚Äì –ø—É—Ç—å –∫ Docker —Å–æ–∫–µ—Ç—É                    |
| `DOCKER_HOST`              | –ê–¥—Ä–µ—Å Docker registry                                                 |
| `DOCKER_IMAGE`             | –ò–º—è Docker –æ–±—Ä–∞–∑–∞ —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º                                        |

## üìú –û—Å–Ω–æ–≤–Ω—ã–µ —ç—Ç–∞–ø—ã –ø–∞–π–ø–ª–∞–π–Ω–∞

1. **–°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–∞**: –°–æ–±–∏—Ä–∞–µ—Ç Docker –æ–±—Ä–∞–∑ –∏ –ø—É—à–∏—Ç –µ–≥–æ –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–π Docker registry.
2. **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞**:
    - **SonarQube** –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞.
    - **Bandit** —Å–∫–∞–Ω–∏—Ä—É–µ—Ç Python –∫–æ–¥ –Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–∏.
    - **Safety** –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —É—è–∑–≤–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫.
3. **–î–µ–ø–ª–æ–π –≤ Kubernetes**: –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–µ–ø–ª–æ–∏—Ç—Å—è –≤ –∫–ª–∞—Å—Ç–µ—Ä.

## üöÄ –î–µ–ø–ª–æ–π –≤ Kubernetes

–ü—Ä–∏–º–µ—Ä Kubernetes –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞ –¥–ª—è –¥–µ–ø–ª–æ—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: your-app
  namespace: your-namespace
spec:
  replicas: 2
  selector:
    matchLabels:
      app: your-app
  template:
    metadata:
      labels:
        app: your-app
    spec:
      containers:
      - name: your-app
        image: ${DOCKER_IMAGE}:latest
        ports:
        - containerPort: 80
```

## üìù –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞ –≤ GitLab

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ GitLab Runner –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Docker.
2. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è Kubernetes –∏ Docker registry –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞:  
   `Settings > CI/CD > Variables`.
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ SonarQube –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞.

---

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —ç—Ç–æ—Ç DevSecOps –ø–∞–π–ø–ª–∞–π–Ω –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ–ª–Ω—É—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é: –æ—Ç –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∫–æ–¥–∞ –¥–æ –µ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –≤ Kubernetes, –≤–∫–ª—é—á–∞—è –ø—Ä–æ–≤–µ—Ä–∫—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∫–∞—á–µ—Å—Ç–≤–∞ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ.
